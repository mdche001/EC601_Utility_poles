!function(a){var b={buildMap:function(b){var c=a(b),d=c.find('input[name="pgm-info"]');if(!(d.length<1)){var e=a.parseJSON(d.val()),f=c.find(".canvas").get(0);if(f){var g=new google.maps.LatLng(e.latitude,e.longitude),h=a.extend({center:g},e.mapOptions),i=new google.maps.Map(f,h),j=a.extend({position:g,map:i},e.markerOptions),k=new google.maps.Marker(j);c.data("google-maps",i),c.data("google-maps-marker",k);var l=new google.maps.InfoWindow({content:e.description});google.maps.event.addListener(k,"click",function(){l.open(i,k)}),c.trigger("pronamic-google-maps-ready",i)}}},buildMashup:function(b){var c=a(b),d=c.find("ul"),e=a.parseJSON(c.find('input[name="pgmm-info"]').val()),f=c.find(".canvas").get(0);if(f){e.hideList&&d.hide();var g=new google.maps.LatLng(e.center.latitude,e.center.longitude),h=a.extend({center:g},e.mapOptions),i=new google.maps.Map(f,h),j=!1;e.markerClustererOptions&&(j=new MarkerClusterer(i,[],e.markerClustererOptions));var k=!1;e.overlappingMarkerSpiderfierOptions&&(k=new OverlappingMarkerSpiderfier(i,e.overlappingMarkerSpiderfierOptions)),c.data("google-maps",i);var l=new google.maps.InfoWindow,m=new google.maps.LatLngBounds;a.each(e.markers,function(b,d){var e=new google.maps.LatLng(d.lat,d.lng),f=a.extend({position:e},d.options),g=new google.maps.Marker(f);google.maps.event.addListener(g,"click",function(){l.setContent(d.description),l.open(i,g),c.trigger("pronamic-google-maps-infowindow-open",l)}),j&&j.addMarker(g,!1),k&&k.addMarker(g),g.setMap(i),m.extend(e)}),j&&j.repaint(),e.fitBounds&&i.fitBounds(m),c.trigger("pronamic-google-maps-ready",i)}}};a.fn.pronamicGoogleMaps=function(){return this.each(function(){b.buildMap(this)})},a.fn.pronamicGoogleMapsMashup=function(){return this.each(function(){b.buildMashup(this)})};var c=function(){google.maps.visualRefresh=pronamic_google_maps_settings.visualRefresh,a(".pgm").pronamicGoogleMaps(),a(".pgmm").pronamicGoogleMapsMashup()};a(document).ready(function(){c()})}(jQuery);